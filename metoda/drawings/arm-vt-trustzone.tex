% Copyright (c) 2016 Grigory Rechistov <grigory.rechistov@gmail.com>
% This work is licensed under the Creative Commons Attribution-NonCommercial-ShareAlike 4.0 Worldwide.
% To view a copy of this license, visit http://creativecommons.org/licenses/by-nc-sa/4.0/.

% This file allows to produce either a separate PDF/PNG image
% See standalone documentation to understand underlying magic

\documentclass[tikz,convert={density=150,size=600,outext=.png}]{standalone}
\usetikzlibrary{shapes, calc, arrows, fit, positioning, decorations, patterns, decorations.pathreplacing, chains, snakes}
\input{../setup-web-fonts}
\input{../setup-packages}
\graphicspath{{../pictures/}} % path to pictures, trailing slash is mandatory.

% The actual drawing follows
\begin{document}
\begin{tikzpicture}[font=\tiny, every node/.style={draw, minimum height=0.6cm, align=center, inner sep=2pt}, node distance=0.2cm]
    \node[minimum width=1.5cm] (app11) {Приложение 1};
    \node[right =of app11, minimum width=1.5cm] (app12) {Приложение 2};
    \node[right =of app12, minimum width=1.5cm] (app21) {Приложение 1};
    \node[right =of app21, minimum width=1.5cm] (app22) {Приложение 2};
    
    \node[right =of app22, minimum width=1.5cm] (trust1) {Доверенное \\приложение 1};
    \node[right =of trust1, minimum width=1.5cm] (trust2) {Доверенное \\приложение 2};
    
    \node[below =of app11.south west, anchor=north west, minimum width=3.2cm] (os1) {Гостевая ОС 1};
    \node[below =of app21.south west, anchor=north west, minimum width=3.2cm] (os2) {Гостевая ОС 2};
    \node[below =of trust1.south west, anchor=north west, minimum width=3.2cm] (trust-os) {Доверенная ОС};
    
    \node[below =of os1.south west, anchor=north west, minimum width=6.6cm] (vmm) {Монитор виртуальных машин};
    \node[below =of vmm.south west, anchor=north west, minimum width=10.0cm] (trust-vmm) {Монитор TrustZone};
    
    \draw[dashed] ([yshift=0.1cm] trust-vmm.north west) -- ([yshift=0.1cm] trust-vmm.north east);
    \draw[dashed] ([yshift=0.1cm] vmm.north west) -- ([yshift=0.1cm] vmm.north east);
    \draw[dashed] ([xshift=0.1cm, yshift=-0.1cm] vmm.south east) -| ([xshift=0.1cm] app22.north east);
    
\end{tikzpicture}


\end{document}
