% Copyright (c) 2016 Grigory Rechistov <grigory.rechistov@gmail.com>
% This work is licensed under the Creative Commons Attribution-NonCommercial-ShareAlike 4.0 Worldwide.
% To view a copy of this license, visit http://creativecommons.org/licenses/by-nc-sa/4.0/.

% This file allows to produce either a separate PDF/PNG image
% See standalone documentation to understand underlying magic

\documentclass[tikz,convert={density=150,size=600,outext=.png}]{standalone}
\usetikzlibrary{shapes, calc, arrows, fit, positioning, decorations, patterns, decorations.pathreplacing, chains, snakes}
\input{../setup-web-fonts}
\input{../setup-packages}
\graphicspath{{../pictures/}} % path to pictures, trailing slash is mandatory.

% The actual drawing follows
\begin{document}
    \begin{tikzpicture}[font=\scriptsize, >=latex]

    \node (guest) {Гость}; 
    \node[right=3cm of guest] (host) {Хозяин}; 
    
    \node[draw, minimum width = 0.7cm, below =0.5cm of guest] (gi1) {инструкция};
    \node[draw, minimum width = 0.7cm, below = 0cm of gi1] (gi2) {инструкция};
    \node[draw, minimum width = 0.7cm, below = 0cm of gi2] (gi3) {инструкция};
    \node[draw, minimum width = 0.7cm, below = 0cm of gi3] (gi4) {инструкция};
    
    \node[draw, minimum width = 1.5cm, minimum height = 1cm, below =0.5cm of host] (hi1) {капсула};
    \node[draw, minimum width = 1.5cm, minimum height = 2cm, below = 0cm of hi1] (hi2) {капсула};
    \node[draw, minimum width = 1.5cm, minimum height = 0.5cm, below = 0cm of hi2] (hi3) {капсула};
    \node[draw, minimum width = 1.5cm, minimum height = 1cm, below = 0cm of hi3] (hi4) {капсула};
    \node[draw, minimum width = 1.5cm, below = 0cm of hi4] (glue) {клей};
    
    \coordinate[right=3.5cm of glue] (next-block);
    \coordinate[above=1.5cm of hi1] (entry);
    
    \draw[->] (gi1.east) to (hi1.west);
    \draw[->] (gi2.east) to (hi2.west);
    \draw[->] (gi3.east) to (hi3.west);
    \draw[->] (gi4.east) to (hi4.west);
    
    \draw[->, dashed] (glue) -- (next-block) node[midway, above, font=\tiny, align=left] {К следующему \\ блоку трансляции};
    \draw[->, dashed] (entry) -- (hi1.north);
    
    \end{tikzpicture}

\end{document}
