% Copyright (c) 2016 Grigory Rechistov <grigory.rechistov@gmail.com>
% This work is licensed under the Creative Commons Attribution-NonCommercial-ShareAlike 4.0 Worldwide.
% To view a copy of this license, visit http://creativecommons.org/licenses/by-nc-sa/4.0/.

% This file allows to produce either a separate PDF/PNG image
% See standalone documentation to understand underlying magic

\documentclass[tikz,convert={density=150,size=600,outext=.png}]{standalone}
\usetikzlibrary{shapes, calc, arrows, fit, positioning, decorations, patterns, decorations.pathreplacing, chains, snakes}
\input{../setup-web-fonts}
\input{../setup-packages}
\graphicspath{{../pictures/}} % path to pictures, trailing slash is mandatory.

% The actual drawing follows
\begin{document}
    \begin{tikzpicture}[font=\small, >=latex]
    
    \path[font=\ttfamily, inner xsep=0pt] (0,0) -- (10,0) node[pos=0.05, above] (0x0) {0x0} node[pos=0.9, above] (0xffff) {0xffff} node[pos=0.5, above] {\rmfamily Карта 1};
    
    \node[draw, fit=(0x0) (0xffff)] (map1) {};
    % \node[font=\scriptsize, single arrow, text width=2.0cm, text badly centered, draw,  shape border rotate=180, rotate=90, above =0cm of map1, anchor=west] ;
        
    \node[above=of map1] (access) {Доступ};
        
    \path[yshift=-1.5cm] (0,0) -- (10,0) coordinate[pos=0] (dev-a-left) coordinate[pos=0.2] (dev-a-right) coordinate[pos=0.2] (map2-left) coordinate[pos=0.5] (map2-right) coordinate[pos=0.5] (dev-b-left) coordinate[pos=0.7] (dev-b-right) coordinate[pos=0.7] (dev-с-left) coordinate[pos=1.0] (dev-с-right);
    
    \draw[<->] (dev-a-left) -- (dev-a-right) node[midway, above] {Устр. А};
    \draw[very thick, <->] (map2-left) -- (map2-right) node[midway, above] (dev-map2) {\bfseries Карта 2};
    \draw[<->] (dev-b-left) -- (dev-b-right) node[midway, above] {Устр. Б};
    \draw[<->] (dev-с-left) -- (dev-с-right) node[midway, above] {Устр. В};
    
    \path[font=\ttfamily, inner xsep=0pt, yshift=-3.cm] (0,0) -- (10,0) node[pos=0.05, above] (0x0-b) {0x0} node[pos=0.9, above] (0xff) {0xff} node[pos=0.5, above] {\rmfamily Карта 2};
    
    \node[draw, fit=(0x0-b) (0xff)] (map2) {};
    
    \draw[dotted] (map2-left) -- (map2.north west);
    \draw[dotted] (map2-right) -- (map2.north east);
    
    \path[yshift=-4.cm] (0,0) -- (10,0) coordinate[pos=0] (dev-d-left) coordinate[pos=0.7] (dev-d-right) coordinate[pos=0.7] (dev-e-left) coordinate[pos=1.0] (dev-e-right);
    
    \draw[<->] (dev-d-left) -- (dev-d-right) node[midway, above] {Устройство Г};
    \draw[very thick, <->] (dev-e-left) -- (dev-e-right) node[midway, above] (dev-d) {\bfseries Устр. Д};
    
    \draw[>=stealth, ->] (access) -- (map1);
    \draw[>=stealth, ->] (map1) -- (dev-map2);
    \draw[>=stealth, ->] (map2) -- (dev-d);
\end{tikzpicture}


\end{document}
